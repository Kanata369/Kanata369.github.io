<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/k(180x180).png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/k(32x32).png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/k(16x16).png?v=5.1.4">


  <link rel="mask-icon" href="/images/logok.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="兴趣使然的无名blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Kanata&#39;s blog">
<meta property="og:url" content="https://kanata369.github.io/page/3/index.html">
<meta property="og:site_name" content="Kanata&#39;s blog">
<meta property="og:description" content="兴趣使然的无名blog">
<meta property="og:locale">
<meta property="article:author" content="Kanata">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://Kanata369.github.io/page/3/"/>





  <title>Kanata's blog</title>
  








<meta name="generator" content="Hexo 6.1.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Kanata's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://Kanata369.github.io/2022/07/12/BUPT-2022-summer-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kanata's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/07/12/BUPT-2022-summer-4/" itemprop="url">BUPT-2022-summer-4</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-07-12T21:20:54+08:00">
                2022-07-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/BUPT/" itemprop="url" rel="index">
                    <span itemprop="name">BUPT</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <span id="more"></span>
<h2 id="B-多阶段dp"><a href="#B-多阶段dp" class="headerlink" title="B(多阶段dp)"></a>B(多阶段dp)</h2><p>大致题意:有若干个任务，有x、t、y、r四个属性(y&lt;=x,r&lt;=t)，有两个阶段，到达第一阶段需要s1经验值，到达第二阶段需要s2经验值，任务属性中，x表示在到达第一阶段<strong>前</strong>完成该任务所奖励的经验值，y表示在到达第一阶段<strong>后</strong>完成该任务所奖励的经验值，t表示在在到达第一阶段<strong>前</strong>完成该任务所花费的时间，r表示在到达第一阶段<strong>后</strong>完成该任务所花费的时间，先求到达第二阶段需要花费的最少时间</p>
<p>题解:最少时间+二维变量，一看很像背包，但两个阶段所需经验不同、任务数完成情况繁多，明显无法用背包来维护状态</p>
<p>故用dp[i][j]来表示状态，表示第一阶段<strong>前</strong>所获经验值=i，第一阶段<strong>后</strong>所获经验值=j时，所花费的最少时间</p>
<p>则dp[i][j]=min{dp[i][j],dp[i-a[k].x][j]+a[k].t,dp[i][j-a[k].y]+a[k].r}(即分别考虑第k个任务是在第一阶段前还是第一阶段后完成还是不完成，取最小值)</p>
<p>细节:任务的处理顺序—若不是从按x的从小到大顺序，会有什么问题?</p>
<p>在同一个阶段内状态转移时，类似于背包，任务的顺序不会产生影响，而overflow时，任务的顺序会产生影响</p>
<p>假设最佳方案时第一阶段的完成任务，按其x值递增排列是(1,2,3,4,5,6)，任务6完成第一阶段并将部分经验值转移到第二阶段，前5个任务随意打乱顺序都不会影响结果(都不会完成第一阶段，相当于一个类似背包的普通dp)，但如果将第6个任务提前，比如(6,5,4,3,2,1)，有可能提前完成第一阶段而导致不是最佳结果。</p>
<p>故将任务按x的顺序从小到大排，确保第一阶段完成前任务的完成顺序按递增顺序排列</p>
<p>下列代码根据j、k的情况分三类讨论:</p>
<ol>
<li>j&lt;=s1，不会overflow，按正常dp方程处理</li>
<li>j大于s1,此时会发生overflow，k需减去第一阶段转移来的多余值</li>
<li>k不存在跨阶段问题，故按普通dp方程处理</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;algorithm&gt;</span><br><span class="line">#include &lt;cmath&gt;</span><br><span class="line">#include &lt;cstdio&gt;</span><br><span class="line">#include &lt;cstring&gt;</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;list&gt;</span><br><span class="line">#include &lt;map&gt;</span><br><span class="line">#include &lt;queue&gt;</span><br><span class="line">#include &lt;set&gt;</span><br><span class="line">#include &lt;stack&gt;</span><br><span class="line">#include &lt;string&gt;</span><br><span class="line">#include &lt;time.h&gt;</span><br><span class="line">#include &lt;unordered_set&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">using ll = int64_t;</span><br><span class="line">/*head*/</span><br><span class="line"></span><br><span class="line">#define fi first</span><br><span class="line">#define se second</span><br><span class="line">#define FOR(i, a, b) for (ll i = (a); i &lt;= (b); i++)</span><br><span class="line">//#define DE_BUG</span><br><span class="line">/*define*/</span><br><span class="line">inline int read()</span><br><span class="line">&#123;</span><br><span class="line">    int s = 0, f = 1;</span><br><span class="line">    char ch = getchar();</span><br><span class="line">    while (ch &lt; &#x27;0&#x27; || ch &gt; &#x27;9&#x27;)</span><br><span class="line">    &#123;</span><br><span class="line">        if (ch == &#x27;-&#x27;)</span><br><span class="line">            f = -1;</span><br><span class="line">        ch = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    while (ch &gt;= &#x27;0&#x27; &amp;&amp; ch &lt;= &#x27;9&#x27;)</span><br><span class="line">    &#123;</span><br><span class="line">        s = s * 10 + ch - &#x27;0&#x27;;</span><br><span class="line">        ch = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    return s * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">inline void write(int x)</span><br><span class="line">&#123;</span><br><span class="line">    if (x &lt; 0)</span><br><span class="line">    &#123;</span><br><span class="line">        putchar(&#x27;-&#x27;);</span><br><span class="line">        x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    if (x &gt; 9)</span><br><span class="line">        write(x / 10);</span><br><span class="line">    putchar(x % 10 + &#x27;0&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">const ll maxn = 500 + 5;</span><br><span class="line">ll dp[2*maxn + 5][2*maxn + 5];</span><br><span class="line">struct node</span><br><span class="line">&#123;</span><br><span class="line">    ll x, t, y, r;</span><br><span class="line">    bool operator&lt;(const node &amp;b)</span><br><span class="line">    &#123;</span><br><span class="line">        return x &lt; b.x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">node a[maxn];</span><br><span class="line">ll tmp, T, n, m, s1, s2;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    T = 1;</span><br><span class="line">    cin.tie(0);</span><br><span class="line">    ios::sync_with_stdio(false);</span><br><span class="line">    while (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">        for (ll i = 1; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            cin &gt;&gt; a[i].x &gt;&gt; a[i].t &gt;&gt; a[i].y &gt;&gt; a[i].r;</span><br><span class="line">        &#125;</span><br><span class="line">        sort(a + 1, a + 1 + n);</span><br><span class="line">        for (ll i = 2*maxn; i &gt;= 0; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            for (ll j = 2*maxn; j &gt;= 0; j--)</span><br><span class="line">            &#123;</span><br><span class="line">                dp[i][j] = 6e12;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        // memset(dp, 0x3f, sizeof(dp));</span><br><span class="line">        ll noans = dp[1][1];</span><br><span class="line">        // cout &lt;&lt; noans &lt;&lt; &quot;\n&quot;;</span><br><span class="line">        dp[0][0] = 0;</span><br><span class="line">        for (ll i = 1; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            for (ll j = 2*maxn; j &gt;= 0; j--)</span><br><span class="line">            &#123;</span><br><span class="line">                for (ll k =2* maxn; k &gt;= 0; k--)</span><br><span class="line">                &#123;</span><br><span class="line">                    if (j &lt;= s1 &amp;&amp; j - a[i].x &gt;= 0)</span><br><span class="line">                    &#123;</span><br><span class="line">                        dp[j][k] = min(dp[j - a[i].x][k] + a[i].t, dp[j][k]);</span><br><span class="line">                        // if(dp[j][k]&lt;noans)</span><br><span class="line">                        // &#123;</span><br><span class="line">                        //    cout &lt;&lt; j &lt;&lt; &quot; &quot; &lt;&lt; k &lt;&lt; &quot; &quot;&lt;&lt;dp[j][k] &lt;&lt; &quot;!!!!\n&quot;;</span><br><span class="line">                        //&#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    if (j &gt;= a[i].x &amp;&amp; j - a[i].x &lt; s1 &amp;&amp; j &gt; s1 &amp;&amp; k - j + s1 &gt;= 0)</span><br><span class="line">                    &#123;</span><br><span class="line">                        dp[j][k] = min(dp[j][k], dp[j - a[i].x][k - (j - s1)] + a[i].t);</span><br><span class="line">                        // if(dp[s1][k]&lt;noans)</span><br><span class="line">                        // cout &lt;&lt; j &lt;&lt; &quot; &quot; &lt;&lt; k &lt;&lt; &quot; &quot;&lt;&lt;dp[s1][k] &lt;&lt; &quot;!!!!\n&quot;;</span><br><span class="line">                    &#125;</span><br><span class="line">                    if (k - a[i].y &gt;= 0)</span><br><span class="line">                    &#123;</span><br><span class="line">                        dp[j][k] = min(dp[j][k - a[i].y] + a[i].r, dp[j][k]);</span><br><span class="line">                        // if(dp[j][k]&lt;noans)</span><br><span class="line">                        // &#123;</span><br><span class="line">                        // cout &lt;&lt; j &lt;&lt; &quot; &quot; &lt;&lt; k &lt;&lt;&quot; &quot;&lt;&lt; dp[j][k] &lt;&lt; &quot;!!\n&quot;;</span><br><span class="line">                        // &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ll ans = noans;</span><br><span class="line">        for (ll i = s1; i &lt;= 2*maxn; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            for (ll j = s2; j &lt;= 2*maxn; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                ans = min(ans, dp[i][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if (ans != noans)</span><br><span class="line">            cout &lt;&lt; ans &lt;&lt; &quot;\n&quot;;</span><br><span class="line">        else</span><br><span class="line">            cout &lt;&lt; &quot;-1\n&quot;;</span><br><span class="line">#ifdef DE_BUG</span><br><span class="line">        cout &lt;&lt; &quot;TIME==&quot; &lt;&lt; (ll)(clock()) - tt &lt;&lt; &quot;\n&quot;;</span><br><span class="line">        tt = (ll)clock();</span><br><span class="line">#endif</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>《关于我因为数组大小没开对wa了半天这件事》</p>
<h2 id="F-博弈论-图论-树上问题"><a href="#F-博弈论-图论-树上问题" class="headerlink" title="F(博弈论+图论+树上问题)"></a>F(博弈论+图论+树上问题)</h2><p>大致题意:给定一颗树，在树上进行游戏，游戏规则如下：</p>
<ol>
<li>A可选定一个节点作为chip出发点，之后由B开始游戏</li>
<li>当轮到本人操作时，可选择将chip移至当前节点的子节点或父节点处(即与之相邻的节点)，但同一节点不能多次到达，若无法继续移动，则判本人负</li>
</ol>
<p>题解:</p>
<p>在场上想的是所有的路径只能分为3类，只上、只下和先上后下，如果只下很容易处理，套用博弈论中的必胜点和必输点+树形dp就行，只上的情况根据每个节点的深度也可得出，但先上后下的情况过于复杂</p>
<p>引入图论中完全匹配的概念:</p>
<ol>
<li>完全匹配是数量最多的一组边集，满足每条边的左右节点都只出现一次</li>
<li>若所有节点都在该边集出现过一次，则称该图完美匹配</li>
</ol>
<p>将树看成图，结论:若图是完美匹配图，则Bob必胜，否则Alice必胜</p>
<p>证明如下：</p>
<ol>
<li>若图是完美匹配图，则可将所有点划分成(s1,s2),(s3,s4)…若干个二元组，则当Alice选定任意个节点，Bob都可将其移动到其对应节点上，由于不能多次到达同一节点，Alice只能选择其他二元组的节点，Bob仍可重复上述操作直至所有节点都被遍历完毕，Bob胜利</li>
<li>若图不是完美匹配，设存在最大匹配(s1,s2),(s3,s4)…若干个二元组，有t个点不在该点集内，则Alice可选择不在该点集内的点开始游戏，Bob只能移动到该点集内的一个点(否则两个不在点集内的点也能匹配，与最大匹配相悖)，此时Alice可重复1中Bob操作，Bob输。若Bob可移动到不在该点集内的点，注意，，一开始时通过一个集外节点进入匹配点集，若再次从匹配点集到达集外节点，可将二元组重新分配且匹配数+1(画个图就很好理解)，与最大匹配定义相悖。</li>
</ol>
<p>按正常图的方法求最大匹配，时间复杂度过大，而本题是特殊的树形结构，运用树形dp可在O(n)内求出任意子树的最大匹配情况</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">int</span>;</span><br><span class="line"><span class="comment">/*head*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FOR(i, a, b) for (ll i = (a); i &lt;= (b); i++)</span></span><br><span class="line"><span class="comment">//#define DE_BUG</span></span><br><span class="line"><span class="comment">/*define*/</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> s = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        s = s * <span class="number">10</span> + ch - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">        x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> ll maxn = <span class="number">100005</span>;</span><br><span class="line">vector&lt;ll&gt; g[maxn];</span><br><span class="line">ll dp[maxn];</span><br><span class="line">ll T, n;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(ll x,ll fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp;e:g[x])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(e==fa)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">dfs</span>(e, x);</span><br><span class="line">        cnt += dp[e];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(cnt==<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        dp[x] = <span class="number">1</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        dp[x] = cnt - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T = <span class="number">1</span>;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; n;</span><br><span class="line">        ll x, y;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n - <span class="number">1</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            cin &gt;&gt; x &gt;&gt; y;</span><br><span class="line">            g[x].<span class="built_in">push_back</span>(y);</span><br><span class="line">            g[y].<span class="built_in">push_back</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span>(dp[<span class="number">1</span>]==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;Bob\n&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;Alice\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> DE_BUG</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;TIME==&quot;</span> &lt;&lt; (ll)(<span class="built_in">clock</span>()) - tt &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        tt = (ll)<span class="built_in">clock</span>();</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>dp[i]表示以i为根的子树其<strong>不匹配</strong>的点数量，为0表示该子树完美匹配</p>
<p>今天被博弈论爆打的教训:1.不要纠结于每个人如何作出最佳操作，有时候只看结果思路更简单;2.图和博弈论可以根据完美匹配的定义结合，多留意一下</p>
<h2 id="E"><a href="#E" class="headerlink" title="E"></a>E</h2><p>坑位预定</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://Kanata369.github.io/2022/07/09/BUPT-2022-summer-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kanata's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/07/09/BUPT-2022-summer-3/" itemprop="url">BUPT-2022-summer-3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-07-09T21:31:24+08:00">
                2022-07-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/BUPT/" itemprop="url" rel="index">
                    <span itemprop="name">BUPT</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <span id="more"></span>
<h2 id="B-图论-贪心dp"><a href="#B-图论-贪心dp" class="headerlink" title="B(图论+贪心dp)"></a>B(图论+贪心dp)</h2><p>给定一张节点数小于1e5的无环无向图，有以下规定:</p>
<ol>
<li>你可以强制monitor任意节点</li>
<li>被强制monitor的节点，其相邻节点和对应的连边都会被monitor</li>
<li>若一条边被monitor，则其对应的节点也被monitor</li>
<li>若一个边的对应两个节点都被monitor，则该边也被monitor</li>
<li>若一个节点和k条边相连，若k-1条边都被monitor，则剩下一条边也被monitor</li>
</ol>
<p>现要求所有的节点和边都被monitor，求最少需要强制monitor多少个节点</p>
<p>正解:复杂的规则+图，考虑用dfs+贪心转移解决</p>
<p>考虑当前节点和其所有子节点、父节点，假设未被monitor子节点数为k</p>
<p>若k&gt;=2,则对当前节点强制monitor能monitor所有子节点和父节点，若不对当前节点强制monitor，则在当前节点不为强制monitor的情况下，想要monitor其子节点，必须强制monitor子节点本身(因为k&gt;=2不能满足规则5使边被monitor)，由于k&gt;=2，故此时强制monitor当前节点花费最小且成效最大(父节点也被monitor)</p>
<p>若k==1，则依据规则3、4可知，该子节点的其他边都未被monitor，该子节点和当前节点的连边也未被monitor，当前节点与其父节点的连边monitor后，则该子节点与当前节点的连边也被monitor，则该子节点和该节点的所有边都会被monitor，故我们延后处理(即不做任何处理)</p>
<p>若k==0，则所有子节点都被monitor，如果当前节点也被monitor，则当前节点与父节点的连边，根据规则5，也被monitor，再根据规则3，当前节点的父节点也一定会被monitor；如果当前节点没被monitor，则无事发生</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">int64_t</span>;</span><br><span class="line"><span class="comment">/*head*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FOR(i, a, b) for (ll i = (a); i &lt;= (b); i++)</span></span><br><span class="line"><span class="comment">//#define DE_BUG</span></span><br><span class="line"><span class="comment">/*define*/</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> s = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        s = s * <span class="number">10</span> + ch - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">        x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> ll maxn = <span class="number">100005</span>;</span><br><span class="line">ll tmp, T, n, m;</span><br><span class="line"><span class="type">bool</span> vis[maxn];</span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line">vector&lt;ll&gt; g[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(ll x,ll fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span>&amp;e:g[x])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(e!=fa)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">dfs</span>(e, x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll cnt = <span class="number">0</span>;</span><br><span class="line">    ll tmp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span>&amp;e:g[x])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(e!=fa)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(!vis[e])</span><br><span class="line">            &#123;</span><br><span class="line">                cnt++;</span><br><span class="line">                tmp = e;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(cnt&gt;=<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        vis[x] = <span class="number">1</span>;</span><br><span class="line">        vis[fa] = <span class="number">1</span>;</span><br><span class="line">        ans++;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(cnt==<span class="number">0</span>&amp;&amp;vis[x]==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        vis[fa] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T = <span class="number">1</span>;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="comment">//cin &gt;&gt; T;</span></span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; n;</span><br><span class="line">        ll x, y;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt; n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            cin &gt;&gt; x &gt;&gt; y;</span><br><span class="line">            g[x].<span class="built_in">push_back</span>(y);</span><br><span class="line">            g[y].<span class="built_in">push_back</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span>(!vis[<span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            ans++;</span><br><span class="line">            vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> DE_BUG</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;TIME==&quot;</span> &lt;&lt; (ll)(<span class="built_in">clock</span>()) - tt &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        tt = (ll)<span class="built_in">clock</span>();</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在场上的时候没读懂规则3和规则4</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://Kanata369.github.io/2022/07/07/BUPT-2022-summer-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kanata's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/07/07/BUPT-2022-summer-2/" itemprop="url">BUPT-2022-summer-2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-07-07T19:48:02+08:00">
                2022-07-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/BUPT/" itemprop="url" rel="index">
                    <span itemprop="name">BUPT</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <span id="more"></span>
<h2 id="A-数据结构-区间更新、查询最值线段树"><a href="#A-数据结构-区间更新、查询最值线段树" class="headerlink" title="A(数据结构:区间更新、查询最值线段树)"></a>A(数据结构:区间更新、查询最值线段树)</h2><p>大致题意：给定n个闭区间，求两个点，使包含这两个点的总数最多</p>
<p>题解:</p>
<p>很明显是离散化后用数据结构维护，想了个先找被包含区间数最大的点，去掉该点后找第二个点的错误贪心</p>
<p>正解:首先，我们规定，选取的第一个点始终位于第二个点的左侧。</p>
<p>离散化后将所有区间按左端点从大到小排列，再从大到小用i枚举点，将所有左端点大于i的区间加入，记录此时的最大值作为f[i]，则此时f[i]表示不包含左端点小于等于i的区间的情况下，能找到一个点，满足包含这个点的最多的区间数。</p>
<p>当所有区间都加入后，用i遍历所有点，f[i]+包含i的区间总数则为可能答案</p>
<p>证明:包含i的区间总数很好理解，即枚举第一条直线的位置，而f[i]则表示消除包含该条直线后的区间后，第二条直线能达到的最大区间数（其他区间要么对答案根本没贡献—完全位于i点左侧，要么包含i)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">int64_t</span>;</span><br><span class="line"><span class="comment">/*head*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FOR(i, a, b) for (ll i = (a); i &lt;= (b); i++)</span></span><br><span class="line"><span class="comment">//#define DE_BUG</span></span><br><span class="line"><span class="comment">/*define*/</span></span><br><span class="line">ll n, m, T;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> s = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        s = s * <span class="number">10</span> + ch - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">        x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">    ll leftx, lefty, rightx, righty;</span><br><span class="line">    <span class="keyword">friend</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(node &amp;a, node &amp;b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> a.righty &lt; b.righty;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">node a[<span class="number">100005</span>];</span><br><span class="line">ll tmp;</span><br><span class="line">ll lsh[<span class="number">200005</span>];</span><br><span class="line"><span class="type">const</span> ll maxn = <span class="number">200005</span>;</span><br><span class="line">ll num;</span><br><span class="line">ll ans[<span class="number">200005</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">seg_node</span></span><br><span class="line">&#123;</span><br><span class="line">    ll val;</span><br><span class="line">    ll lazy;</span><br><span class="line">&#125; segtree[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(ll rt)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    segtree[rt].val = <span class="built_in">max</span>(segtree[rt &lt;&lt; <span class="number">1</span>].val, segtree[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(ll rt, ll ln, ll rn)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (segtree[rt].lazy)</span><br><span class="line">    &#123;</span><br><span class="line">        segtree[rt &lt;&lt; <span class="number">1</span>].lazy += segtree[rt].lazy;</span><br><span class="line">        segtree[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].lazy += segtree[rt].lazy;</span><br><span class="line">        segtree[rt &lt;&lt; <span class="number">1</span>].val +=  segtree[rt].lazy;</span><br><span class="line">        segtree[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].val +=  segtree[rt].lazy;</span><br><span class="line">        segtree[rt].lazy = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(ll left = <span class="number">1</span>, ll right = num, ll rt = <span class="number">1</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    segtree[rt].lazy = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (left == right)</span><br><span class="line">    &#123;</span><br><span class="line">        segtree[rt].val = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(left, mid, rt &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">build</span>(mid + <span class="number">1</span>, right, rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">pushup</span>(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">part_query</span><span class="params">(ll l, ll r, ll left = <span class="number">1</span>, ll right = num, ll rt = <span class="number">1</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= left &amp;&amp; r &gt;= right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> segtree[rt].val; <span class="comment">//+segtree[rt].lazy;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; right || r &lt; left)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">pushdown</span>(rt, mid - left + <span class="number">1</span>, right - mid);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(<span class="built_in">part_query</span>(l, r, left, mid, rt &lt;&lt; <span class="number">1</span>), <span class="built_in">part_query</span>(l, r, mid + <span class="number">1</span>, right, rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">part_update</span><span class="params">(ll l, ll r, ll value, ll left = <span class="number">1</span>, ll right = num, ll rt = <span class="number">1</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= left &amp;&amp; r &gt;= right)</span><br><span class="line">    &#123;</span><br><span class="line">        segtree[rt].val += value;</span><br><span class="line">        segtree[rt].lazy += value;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">pushdown</span>(rt, mid - left + <span class="number">1</span>, right - mid);</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">part_update</span>(l, r, value, left, mid, rt &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (r &gt; mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">part_update</span>(l, r, value, mid + <span class="number">1</span>, right, rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pushup</span>(rt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T = <span class="number">1</span>;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; n;</span><br><span class="line">        <span class="comment">//ll ans = 0;</span></span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            cin &gt;&gt; a[i].leftx &gt;&gt; a[i].lefty &gt;&gt; a[i].rightx &gt;&gt; a[i].righty;</span><br><span class="line">            lsh[i] = a[i].righty;</span><br><span class="line">            lsh[i + n] = a[i].lefty;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(lsh + <span class="number">1</span>, lsh + <span class="number">1</span> + <span class="number">2</span> * n);</span><br><span class="line">        <span class="comment">// memset(tree, 0, sizeof(tree));</span></span><br><span class="line">        num = <span class="built_in">unique</span>(lsh + <span class="number">1</span>, lsh + <span class="number">1</span> + <span class="number">2</span> * n) - lsh - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            a[i].lefty = <span class="built_in">lower_bound</span>(lsh + <span class="number">1</span>, lsh + <span class="number">1</span> + num, a[i].lefty) - lsh;</span><br><span class="line">            a[i].righty = <span class="built_in">lower_bound</span>(lsh + <span class="number">1</span>, lsh + <span class="number">1</span> + num, a[i].righty) - lsh;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(a + <span class="number">1</span>, a + <span class="number">1</span> + n);</span><br><span class="line">         <span class="comment">//reverse(a + 1 + n, a + 1);</span></span><br><span class="line">         <span class="comment">//cout &lt;&lt; a[n].righty &lt;&lt; &quot;!!!\n&quot;;</span></span><br><span class="line">        <span class="comment">// build(1, num, 1);</span></span><br><span class="line">        <span class="built_in">build</span>(<span class="number">1</span>,num,<span class="number">1</span>);</span><br><span class="line">        ll now = n;</span><br><span class="line">        <span class="keyword">for</span> (ll i = num; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (now&gt;=<span class="number">1</span>&amp;&amp;a[now].righty &gt; i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">part_update</span>(a[now].righty, a[now].lefty, <span class="number">1</span>,<span class="number">1</span>,num,<span class="number">1</span>);</span><br><span class="line">                now--;</span><br><span class="line">            &#125;</span><br><span class="line">            ans[i] = <span class="built_in">part_query</span>(i, num,<span class="number">1</span>,num,<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (now &gt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">part_update</span>(a[now].righty, a[now].lefty, <span class="number">1</span>,<span class="number">1</span>,num,<span class="number">1</span>);</span><br><span class="line">            now--;</span><br><span class="line">        &#125;</span><br><span class="line">        ll mx = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= num; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            ans[i] += <span class="built_in">part_query</span>(i, i,<span class="number">1</span>,num,<span class="number">1</span>);</span><br><span class="line">            mx = <span class="built_in">max</span>(ans[i], mx);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        cout &lt;&lt; mx &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> DE_BUG</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;TIME==&quot;</span> &lt;&lt; (ll)(<span class="built_in">clock</span>()) - tt &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        tt = (ll)<span class="built_in">clock</span>();</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个线段树写法是硬改的。。不怎么优雅，而且常数很大</p>
<hr>
<h2 id="B-图论、Floyd"><a href="#B-图论、Floyd" class="headerlink" title="B(图论、Floyd)"></a>B(图论、Floyd)</h2><p>题意:给定m个物品，n个人对所有物品进行喜好度分级(可能多个物品同一级)，先规定d(x,y)为比起y更喜欢x的人数，现有路径<script type="math/tex">x,i_{1},i_{2},....,y</script>,满足条件d(t,t+1)&gt;d(t+1,t)(即路径中相邻两项中，比起右项更喜欢左项的人数要严格大于比起左项更喜欢右项的人数)，在所有d(t,t+1)中，取最小值作为S(x,y)的预备值，在所有预备值中，取最大值作为S(x,y)，若不存在路径，则规定S(x,y)=0,若S(x,y)&gt;=S(y,x)，当y为除了x的任意值时，都成立，则输出x，要求找出所有x(m&lt;500,n&lt;500)</p>
<p>题解:</p>
<p>图论题，用d[x,y]存储比起y更喜欢x的人数后，将所有不能形成路径的d消去(避免影响后续计算)，类似Floyd算法，规定dp[k,x,y]表示x、y之间路径不包含编号超过k的节点时，S(x,y)的最大值，当k=0时，dp[0,x,y]=d[x,y]/(前提是d[x,y]有意义，即能形成路径)，之后枚举k进行计算，得到S值，再枚举所有S值得到答案。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">int64_t</span>;</span><br><span class="line"><span class="comment">/*head*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FOR(i, a, b) for (ll i = (a); i &lt;= (b); i++)</span></span><br><span class="line"><span class="comment">//#define DE_BUG</span></span><br><span class="line"><span class="comment">/*define*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> s = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        s = s * <span class="number">10</span> + ch - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">        x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> ll maxn = <span class="number">505</span>;</span><br><span class="line"><span class="type">const</span> ll INF = <span class="number">0x7fffffff</span>;</span><br><span class="line">ll T, n, m;</span><br><span class="line"><span class="comment">//ll S[maxn][maxn];</span></span><br><span class="line">ll d[maxn][maxn];</span><br><span class="line">ll a[maxn];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T = <span class="number">1</span>;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; m &gt;&gt; n;</span><br><span class="line">        <span class="comment">/*if(m==1)</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            cout &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line"><span class="comment">            continue;</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line">        <span class="built_in">memset</span>(d, <span class="number">0</span>, <span class="built_in">sizeof</span>(d));</span><br><span class="line">        <span class="comment">//memset(S, 0, sizeof(S));</span></span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (ll j = <span class="number">1</span>; j &lt;= m;j++)</span><br><span class="line">            &#123;</span><br><span class="line">                cin &gt;&gt; a[j];</span><br><span class="line">                <span class="keyword">if</span>(a[j]==<span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    a[j] = INF;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span> (ll k = <span class="number">1</span>; k &lt; j;k++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span>(a[j]!=<span class="number">0</span>&amp;&amp;a[j]&lt;a[k])</span><br><span class="line">                    &#123;</span><br><span class="line">                        d[j][k]++;</span><br><span class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(a[k]!=<span class="number">0</span>&amp;&amp;a[k]&lt;a[j])</span><br><span class="line">                    &#123;</span><br><span class="line">                        d[k][j]++;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= m;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (ll j = <span class="number">1</span>; j &lt; i;j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(d[i][j]==d[j][i])</span><br><span class="line">                &#123;</span><br><span class="line">                    d[i][j] = <span class="number">0</span>;</span><br><span class="line">                    d[j][i] = <span class="number">0</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(d[i][j]&gt;d[j][i])</span><br><span class="line">                &#123;</span><br><span class="line">                    d[j][i] = <span class="number">0</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(d[i][j]&lt;d[j][i])</span><br><span class="line">                &#123;</span><br><span class="line">                    d[i][j] = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                d[i][i] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (ll k = <span class="number">1</span>; k &lt;= m;k++)<span class="comment">//类似Floyd</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= m;i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (ll j = <span class="number">1</span>; j &lt;= m;j++)</span><br><span class="line">                &#123;</span><br><span class="line">                    d[i][j] = <span class="built_in">max</span>(d[i][j], <span class="built_in">min</span>(d[i][k], d[k][j]));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= m;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">bool</span> flag = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (ll j = <span class="number">1</span>; j &lt;= m;j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(i==j)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(d[i][j]&lt;d[j][i])</span><br><span class="line">                &#123;</span><br><span class="line">                    flag = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(flag)</span><br><span class="line">            &#123;</span><br><span class="line">                cout &lt;&lt; i &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="E-二分-贪心"><a href="#E-二分-贪心" class="headerlink" title="E(二分+贪心)"></a>E(二分+贪心)</h2><p>题意:给定n组数据(x,y)，根据题意求出误差最小值</p>
<p>题解:小数二分误差值，check使用贪心</p>
<p>check具体流程:将所有点按x坐标从左到右排好之后，先找到pos满足pos前的所有值都小于等于给定值，之后到达第二阶段；易知同一分段内的最大值最小值之差不能大于2<em>给定值，根据最大最小值更新第二阶段可能的最小值，直至不满足条件，将其作为pos；之后所有点都归为第三个分段，而第三个分段满足的条件是:1.最大值、最小值之差不能大于2</em>给定值2.最小值+给定值必须大于第二阶段值</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">int64_t</span>;</span><br><span class="line"><span class="comment">/*head*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FOR(i, a, b) for (ll i = (a); i &lt;= (b); i++)</span></span><br><span class="line"><span class="comment">//#define DE_BUG</span></span><br><span class="line"><span class="comment">/*define*/</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> s = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        s = s * <span class="number">10</span> + ch - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">        x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> ll maxn = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line">ll n;</span><br><span class="line"><span class="type">const</span> ll INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> eps = <span class="number">1e-2</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">    ll x;</span><br><span class="line">    ll y;</span><br><span class="line">    <span class="keyword">friend</span> <span class="type">bool</span> <span class="keyword">operator</span> &lt; (node&amp;a,node&amp;b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> (a.x == b.x) ? (a.y &lt; b.y) : (a.x &lt; b.x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">node a[maxn];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">double</span> err)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll pos = <span class="number">1e9</span> + <span class="number">5</span>;</span><br><span class="line">    ll id1=<span class="number">1</span>, id2;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n;i++)<span class="comment">//1 1 1 2 2</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">abs</span>(a[i].y)&gt;err)</span><br><span class="line">        &#123;</span><br><span class="line">            pos = a[i].x<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i!=n&amp;&amp;a[i].x!=a[i+<span class="number">1</span>].x)</span><br><span class="line">        &#123;</span><br><span class="line">            id1 = i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(pos==<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; &quot;1!!\n&quot;;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(pos==<span class="number">1e9</span>+<span class="number">5</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll mx = <span class="number">-1e9</span><span class="number">-5</span>, mn = <span class="number">1e9</span>+<span class="number">5</span>;</span><br><span class="line">    ll pos2 = <span class="number">1e9</span> + <span class="number">5</span>;</span><br><span class="line">    <span class="type">double</span> val2;</span><br><span class="line">    <span class="keyword">for</span> (ll i = id1; i &lt;= n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i].y&gt;mx||a[i].y&lt;mn)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="number">2</span>*err&lt;<span class="built_in">max</span>(a[i].y,mx)-<span class="built_in">min</span>(a[i].y,mn))</span><br><span class="line">            &#123;</span><br><span class="line">                pos2 = a[i].x - <span class="number">1</span>;</span><br><span class="line">                val2 = <span class="built_in">min</span>(mx - err, mn + err);</span><br><span class="line">                <span class="comment">//val2 = max(val2, 1.0*0);</span></span><br><span class="line">                <span class="comment">//cout &lt;&lt; i &lt;&lt; &quot;debug!!\n&quot;;</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                mx = <span class="built_in">max</span>(mx, a[i].y);</span><br><span class="line">                mn = <span class="built_in">min</span>(mn, a[i].y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i!=n&amp;&amp;a[i].x!=a[i+<span class="number">1</span>].x)</span><br><span class="line">        &#123;</span><br><span class="line">            id2 = i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(pos2==pos)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; val2&lt;&lt;&quot;!&quot;&lt;&lt;&quot;!&quot;&lt;&lt;&quot;!\n&quot;;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(pos2==<span class="number">1e9</span>+<span class="number">5</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    mx = <span class="number">-1e9</span> - <span class="number">5</span>, mn = <span class="number">1e9</span> + <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">for</span> (ll i = id2; i &lt;= n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        mx = <span class="built_in">max</span>(mx, a[i].y);</span><br><span class="line">        mn = <span class="built_in">min</span>(mn, a[i].y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">1.0</span>*(mx-mn)&gt;<span class="number">2</span>*err)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="comment">// cout &lt;&lt; &quot;3!!\n&quot;;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">1.0</span>*mn+err&lt;val2||<span class="number">1.0</span>*mn+err&lt;<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="comment">// cout &lt;&lt; &quot;3!!\n&quot;;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll T = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//cin.tie(0);</span></span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; n;</span><br><span class="line">        <span class="type">double</span> l = <span class="number">0</span>, r;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%lld %lld&quot;</span>, &amp;a[i].x, &amp;a[i].y);</span><br><span class="line">            r = <span class="built_in">max</span>(<span class="built_in">abs</span>(<span class="number">1.0</span>*a[i].y), r);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//r = INF;</span></span><br><span class="line">        <span class="built_in">sort</span>(a + <span class="number">1</span>, a + <span class="number">1</span> + n);</span><br><span class="line">        <span class="type">double</span> mid;</span><br><span class="line">        <span class="keyword">while</span>(r-l&gt;eps)</span><br><span class="line">        &#123;</span><br><span class="line">            mid = (r + l) / <span class="number">2</span>;</span><br><span class="line">            <span class="comment">//cout &lt;&lt; mid &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">check</span>(mid))</span><br><span class="line">            &#123;</span><br><span class="line">                r = mid+<span class="number">1e-3</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                l = mid<span class="number">-1e-3</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.1lf&quot;</span>,(r + l) / <span class="number">2</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> DE_BUG</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;TIME==&quot;</span> &lt;&lt; (ll)(<span class="built_in">clock</span>()) - tt &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        tt = (ll)<span class="built_in">clock</span>();</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://Kanata369.github.io/2022/07/05/BUPT-2022-summer-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kanata's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/07/05/BUPT-2022-summer-1/" itemprop="url">BUPT_2022_summer_1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-07-05T20:00:08+08:00">
                2022-07-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/BUPT/" itemprop="url" rel="index">
                    <span itemprop="name">BUPT</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <span id="more"></span>
<h2 id="F-数据结构-点更新、查询最值线段树"><a href="#F-数据结构-点更新、查询最值线段树" class="headerlink" title="F(数据结构:点更新、查询最值线段树)"></a>F(数据结构:点更新、查询最值线段树)</h2><p>给定N个正整数，N&lt;=400000，数字会重复，但每个数都小于等于N，求字典序最小的A、B满足：该数列中含有A、B、A、B子序列(不一定连续)</p>
<p>题解:第一眼能猜到是个数据结构题，但不会推(</p>
<p>思路1：A、B、A、B，是一个交错结构，可以先想查询ABA子序列，则只需要知道下一个A的位置(预处理中能得到)，在两个位置之间查询最小值即为B，可在NlogN内完成，如果替换成ABAB的情况，则我们需要保证查询到的最小值B，其在两个A的间隔之后，仍存在一个B，很麻烦。</p>
<p>故转化思路，在遍历到<script type="math/tex">a_{i}</script>时，将其看作B，查询BAB中的A，而A是遍历到<script type="math/tex">a_{i}</script>之前插入线段树的，故在两个B之前必定存在一个A</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">int64_t</span>;</span><br><span class="line"><span class="comment">/*head*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FOR(i, a, b) for (ll i = (a); i &lt;= (b); i++)</span></span><br><span class="line"><span class="comment">//#define DE_BUG</span></span><br><span class="line"><span class="comment">/*define*/</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> s = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        s = s * <span class="number">10</span> + ch - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">        x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">400005</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> tmp;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> a[<span class="number">400005</span>];</span><br><span class="line"><span class="type">int</span> nxt[<span class="number">400005</span>];</span><br><span class="line"><span class="type">int</span> lst[<span class="number">400005</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">seg_node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">&#125; segtree[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(ll rt)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    segtree[rt].val = <span class="built_in">min</span>(segtree[rt &lt;&lt; <span class="number">1</span>].val, segtree[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(ll left = <span class="number">1</span>, ll right = n, ll rt = <span class="number">1</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (left == right)</span><br><span class="line">    &#123;</span><br><span class="line">        segtree[rt].val = INF;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(left, mid, rt &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">build</span>(mid + <span class="number">1</span>, right, rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">pushup</span>(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">point_update</span><span class="params">(<span class="type">int</span> point, <span class="type">int</span> value, <span class="type">int</span> left = <span class="number">1</span>, ll right = n, ll rt = <span class="number">1</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (left == right)</span><br><span class="line">    &#123;</span><br><span class="line">        segtree[rt].val = <span class="built_in">min</span>(segtree[rt].val, value);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (point &lt;= mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">point_update</span>(point, value, left, mid, rt &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">point_update</span>(point, value, mid + <span class="number">1</span>, right, rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pushup</span>(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">part_query</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> left = <span class="number">1</span>, <span class="type">int</span> right = n, <span class="type">int</span> rt = <span class="number">1</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= left &amp;&amp; r &gt;= right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> segtree[rt].val;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; right || r &lt; left)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">min</span>(<span class="built_in">part_query</span>(l, r, left, mid, rt &lt;&lt; <span class="number">1</span>), <span class="built_in">part_query</span>(l, r, mid + <span class="number">1</span>, right, rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n = <span class="built_in">read</span>();</span><br><span class="line">    <span class="built_in">memset</span>(lst, <span class="number">0</span>, <span class="built_in">sizeof</span>(lst));</span><br><span class="line">    <span class="built_in">memset</span>(nxt, <span class="number">0</span>, <span class="built_in">sizeof</span>(nxt));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        a[i] = <span class="built_in">read</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        nxt[i] = lst[a[i]];</span><br><span class="line">        lst[a[i]] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> tmp, A = INF, B = INF;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (nxt[i] == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        tmp = <span class="built_in">part_query</span>(i+<span class="number">1</span>, nxt[i]<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">if</span> (tmp != INF)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (tmp &lt; A)</span><br><span class="line">            &#123;</span><br><span class="line">                A = tmp;</span><br><span class="line">                B = a[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (tmp == A)</span><br><span class="line">            &#123;</span><br><span class="line">                B = <span class="built_in">min</span>(B, a[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">point_update</span>(nxt[i], a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (A == INF || B == INF)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">write</span>(<span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">write</span>(A);</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        <span class="built_in">write</span>(B);</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>思路2：题目要求字典序最小，故我们找出满足题目条件的A，在A之间再找B，略复杂</p>
<hr>
<h2 id="G-数学、排列组合计数问题"><a href="#G-数学、排列组合计数问题" class="headerlink" title="G(数学、排列组合计数问题)"></a>G(数学、排列组合计数问题)</h2><p>题意:给定RxC的方格，给定整数K(1&lt;=K&lt;=R*C)，在方格上找到N个矩形，满足所有矩形的共有区域的格数大于等于K，求矩形有多少种摆放方式(注意:矩形的顺序也有影响)</p>
<p>题解:预处理出共有区域大小<strong>刚好</strong>为i的摆放方式，最后枚举i从K到MAX的和</p>
<p>问题:如何预处理以至于不漏、不重复?可以看出共有区域必定是个矩形，故我们从矩形的row和column两方面考虑，若i块矩形，其row的位置有m种可能，column的位置有n种可能，则一共有m*n种摆放方式。故我们只需处理出共有区域的row的长度为1~R时，其所对应的可能数，column的长度从1~C，其所对应的可能数，最后汇总答案即可。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">int64_t</span>;</span><br><span class="line"><span class="comment">/*head*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FOR(i, a, b) for (ll i = (a); i &lt;= (b); i++)</span></span><br><span class="line"><span class="comment">//#define DE_BUG</span></span><br><span class="line"><span class="comment">/*define*/</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> s = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        s = s * <span class="number">10</span> + ch - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">        x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">ll T, n, r, c, k;</span><br><span class="line">ll pr[<span class="number">5005</span>], pc[<span class="number">5005</span>];</span><br><span class="line">ll p[<span class="number">5006</span>];</span><br><span class="line"><span class="function">ll <span class="title">ksm</span><span class="params">(ll x, ll y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ret = (ret * x) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        x = (x * x) % mod;</span><br><span class="line">        y /= <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pre</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll cnt;</span><br><span class="line">    <span class="keyword">for</span> (ll len = <span class="number">1</span>; len &lt;= r; len++)</span><br><span class="line">    &#123;</span><br><span class="line">        cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll l = <span class="number">1</span>; l + len - <span class="number">1</span> &lt;= r; l++)</span><br><span class="line">        &#123;</span><br><span class="line">            cnt += (p[l] - p[l<span class="number">-1</span>])* (p[r - (l + len - <span class="number">1</span>) + <span class="number">1</span>] - p[r - (l + len - <span class="number">1</span>)]) % mod;</span><br><span class="line">            <span class="comment">// cout &lt;&lt; cnt &lt;&lt; &quot;!!\n&quot;;</span></span><br><span class="line">            cnt %= mod;</span><br><span class="line">        &#125;</span><br><span class="line">        pr[len] = cnt;</span><br><span class="line">        <span class="comment">// cout &lt;&lt; &quot;pr&quot; &lt;&lt; len &lt;&lt; &quot;==&quot; &lt;&lt; pr[len] &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (ll len = <span class="number">1</span>; len &lt;= c; len++)</span><br><span class="line">    &#123;</span><br><span class="line">        cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll l = <span class="number">1</span>; l + len - <span class="number">1</span> &lt;= c; l++)</span><br><span class="line">        &#123;</span><br><span class="line">            cnt += (p[l]-p[l<span class="number">-1</span>]) * (p[c - (l + len - <span class="number">1</span>) + <span class="number">1</span>] - p[c - (l + len - <span class="number">1</span>)]) % mod;</span><br><span class="line">            cnt %= mod;</span><br><span class="line">        &#125;</span><br><span class="line">        pc[len] = cnt;</span><br><span class="line">        <span class="comment">// cout &lt;&lt; &quot;pc&quot; &lt;&lt; len &lt;&lt; &quot;==&quot; &lt;&lt; pc[len] &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin.tie(0);</span></span><br><span class="line">    <span class="comment">// ios::sync_with_stdio(false);</span></span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; r &gt;&gt; c &gt;&gt; k;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; <span class="number">5005</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            p[i] = <span class="built_in">ksm</span>(i, n);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">pre</span>();</span><br><span class="line">        ll ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= r; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (ll j = <span class="number">1</span>; j &lt;= c; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (i * j &gt;= k)</span><br><span class="line">                &#123;</span><br><span class="line">                    ans += pr[i] * pc[j];</span><br><span class="line">                    ans %= mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; (ans+mod)%mod &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> DE_BUG</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;TIME==&quot;</span> &lt;&lt; (ll)(<span class="built_in">clock</span>()) - tt &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        tt = (ll)<span class="built_in">clock</span>();</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="D-环型贪心、二倍环展开"><a href="#D-环型贪心、二倍环展开" class="headerlink" title="D(环型贪心、二倍环展开)"></a>D(环型贪心、二倍环展开)</h2><p>题意:给定N个数组成的圆环，求将圆环上的数分割成K组后，每组的OR值的AND值最大</p>
<p>题解:位运算很容易想到从高到低位考虑，当第i位为1的数不足k个，或将其分为k组的分法与更高位的分法相悖时，第i位对答案没有贡献。</p>
<p>我们就考虑1位时，很明显若当前位出现1时，将其划分到一组，最后看能划分出的组数大于等于k，即存在答案</p>
<p>而若考虑2位时，先将最高位按上述处理，若最高位对答案有贡献，则当前位和最高位都为1时，才将其划分到一组，最后也是看划分出的组数是否大于等于k</p>
<p>环问题，则将其转化成2<em>n的序列，则划分出的组数要大于等于2</em>k-1(将环变成二倍环，展开后最多减少1个组数，即2k-1满足条件—如果不扩展成二倍环，无法区分最后组数是否收到展开的影响而-1)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">int64_t</span>;</span><br><span class="line"><span class="comment">/*head*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FOR(i, a, b) for (ll i = (a); i &lt;= (b); i++)</span></span><br><span class="line"><span class="comment">//#define DE_BUG</span></span><br><span class="line"><span class="comment">/*define*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> s = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        s = s * <span class="number">10</span> + ch - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">        x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> ll maxn = <span class="number">100005</span>;</span><br><span class="line">ll tmp;</span><br><span class="line">ll n, m, T, k;</span><br><span class="line">ll a[<span class="number">1000005</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T = <span class="number">1</span>;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            cin &gt;&gt; a[i];</span><br><span class="line">            a[i + n] = a[i];<span class="comment">//将环展开</span></span><br><span class="line">        &#125;</span><br><span class="line">        ll ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">30</span>; i &gt;= <span class="number">0</span>;i--)<span class="comment">//从高位枚举到低位贪心</span></span><br><span class="line">        &#123;</span><br><span class="line">            ll cnt = <span class="number">0</span>, tmp = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (ll j = <span class="number">1</span>; j &lt;=<span class="number">2</span>* n;j++)</span><br><span class="line">            &#123;</span><br><span class="line">                tmp |= a[j];</span><br><span class="line">                <span class="keyword">if</span>(((ans|(<span class="number">1</span>&lt;&lt;i))&amp;(tmp))==(ans|(<span class="number">1</span>&lt;&lt;i)))<span class="comment">//此时的值满足成组条件</span></span><br><span class="line">                &#123;</span><br><span class="line">                    cnt++;</span><br><span class="line">                    tmp = <span class="number">0</span>;<span class="comment">//重置</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(cnt&gt;=<span class="number">2</span>*k<span class="number">-1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ans |= (<span class="number">1</span> &lt;&lt; i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> DE_BUG</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;TIME==&quot;</span> &lt;&lt; (ll)(<span class="built_in">clock</span>()) - tt &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        tt = (ll)<span class="built_in">clock</span>();</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://Kanata369.github.io/2022/07/02/CSAPP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kanata's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/07/02/CSAPP/" itemprop="url">CSAPP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-07-02T10:32:53+08:00">
                2022-07-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%A4%A7%E5%AD%A6%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">大学学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>课程视频:<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1iW411d7hd?share_source=copy_web">https://www.bilibili.com/video/BV1iW411d7hd?share_source=copy_web</a></p>
<h1 id="Lecture02-Bits-Bytes-and-Integer"><a href="#Lecture02-Bits-Bytes-and-Integer" class="headerlink" title="Lecture02:Bits,Bytes,and Integer"></a>Lecture02:Bits,Bytes,and Integer</h1><p>浮点数的二进制表示:100010.101=1*2^5+1*2^1+1*2^(-1)+1*2^(-3)</p>
<p>4个bit分为一组—&gt;十六进制</p>
<p>x86-64上的数据类型:</p>
<ol>
<li>char 1字节—8位</li>
<li>short 2字节—16位</li>
<li>int 4字节—32位</li>
<li>long 8字节—64位</li>
<li>float 4字节—32位</li>
<li>double 8字节—64位</li>
<li>long double 10/16字节(只使用10个字节，当在64位机器上使用时，额外6字节被浪费—保证了一切以16字节对齐)</li>
</ol>
<p>64位机器、32位机器:地址是64位或32位(即pointer的大小)</p>
<p>位移操作(shift)</p>
<p>左移(left shift):将bit-vector向左移动,将溢出位舍弃,在右边填0</p>
<p>右移(right shift):将bit-vector向右移动,将多余位舍弃</p>
<p>signed的逻辑右移(logic shift):在左边填0</p>
<p>signed的算术右移(Arithmetic shift):在左边复制符号位(为什么没有算术左移?左移相当于执行了一次可能会溢出的乘法)</p>
<p>注意:移动&lt;0的数或大于等于数据字节长度的行为,都是UB</p>
<p>二进制到unsigned,signed的转换(T表示two’s complement,即二进制补码形式):</p>
<script type="math/tex; mode=display">B2U(x)=\sum_{i=0}^{w-1}{x_{i}*2^{i} }</script><script type="math/tex; mode=display">B2T(x)=-x_{w-1}*2^{w-1}+\sum_{i=0}^{w-2} {x_{i}*2^{i} }</script><p>即最高位取负数,其他不变,若最高位为1,则一定是负数(最大为-1)</p>
<script type="math/tex; mode=display">UMin=0,UMax=2^{w}-1,TMin=-2^{w-1},TMax=2^{w-1}-1</script><p>|TMin|=TMax+1</p>
<p>UMax=2*TMax+1</p>
<p>B2U,U2B(对同一个bit-vector,建立从signed到unsigned的映射)</p>
<p>注意:在C中,默认常量都是signed,如要使用unsigned需要添加后缀”U”,如0U,4294967259U</p>
<p>当signed,unsigned被混合运算时(如大小比较),signed总被转化成unsigned(bit-vector保持不变,仅仅是转换方式变化)</p>
<p>signed extension(如32位拓展到64位):signed在左边复制符号位(类似算术右移),即从符号位开始的一连串1,可等价于将这串1中,<strong>最低位</strong>作为符号位</p>
<h1 id="Lecture03-Bits-Bytes-and-Integers-cont"><a href="#Lecture03-Bits-Bytes-and-Integers-cont" class="headerlink" title="Lecture03:Bits,Bytes,and Integers cont"></a>Lecture03:Bits,Bytes,and Integers cont</h1><p>Unsigned Addition :相加后无论”多出”的一位是什么,都舍弃掉,可理解为模运算,即<script type="math/tex">UAdd_{w}(u,v)=(u+v)mod {2^{w} }</script></p>
<p>Two’s complement Addition:等价于将两个数都转化为unsigned计算后再转化为signed(即<strong>按位相加</strong>)</p>
<p>正溢出(positive):两个较大正数加在一起使符号位变成1,即得到负数</p>
<p>负溢出(positive):两个较小负数加在一起使符号位变成0,即得到正数</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2356" alt="">.png)</p>
<p>Unsigned Multiplication:相乘后多余位舍弃,可理解为模运算,即<script type="math/tex">UMult_{w}(u,v)=u*v mod{2^{w} }</script></p>
<p>Signed Multiplication:当作<strong>unsigned</strong>相乘后舍弃多余位,剩下的首位作为符号位,如5<em>5=25—&gt;11001—&gt;1001—&gt;-7,若相乘后的数字可以用目前位数表示,则结果正常(注意,这里相乘后的数字指的是<em>*signed相乘结果</em></em>,而不是转化成unsigned后的相乘结果)</p>
<p>注意,负数算术右移时,结果会向负无穷舍入,而不是零(即左侧,事实上这就是二分中通常用&gt;&gt;1的原因),如果想要向零舍入,需要添加一个偏移量(添加偏移量的操作,编译器会在使用<strong>除法</strong>时自动添加,然后在实施<strong>右移</strong>)</p>
<p>??C语言对signed的右移是算术还是逻辑右移没有明确规定,绝大多数情况下是算术右移</p>
<p>移位操作消耗1计算周期,而乘法操作消耗3个计算周期(通过各种硬件优化),除法操作消耗30个计算周期</p>
<p>signed取相反数(x—&gt;-x):将所有位取反,再+1,故Tmin=-Tmin</p>
<hr>
<p>数据是如何存储的:在64位机器中,地址有64位,可以将内存系统理解为一个巨大的char数组,每一个char占据一字节,64位地址能表示的下标从0~2^64,故最多存储2^64字节数据(实际上目前能使用的最大内存地址是47位,对应的内存大小大约是128TB),实际上,只是程序认为它可以使用这么大的空间,当程序运行时,系统会规定其能访问的内存区域,如果程序试图访问其他区域,将报错(即segementation fault)</p>
<p>一般情况下,数据类型的地址取其占有的bytes的最低位地址,如64位地址占据了0000~0007这8个byte,这该地址是0000,类比0008~0015是0008;而32位地址同理,0000~0004是0000,0005~0007是0005(地址表示一般情况下使用十六进制)</p>
<p>字长(Word Size):没有明确规定,当我们提及64位机器时,指的是其pointer/地址大小是64位(尽管只使用了47位)</p>
<p>使用GCC编译时,可以指定它是64位还是32位,会生成两种不同类似的object code,即硬件本身不一定定义字节大小,是硬件和编译器一起决定(64位的代码也可兼容32位机器)</p>
<p>multi-byte word是如何在内存中排序的?</p>
<p>小端序(little endian):最低有效byte拥有最低位地址(x86,IOS,Windows,ARM processors running Android)</p>
<p>大端序(big endian):最低有效byte拥有最高位地址(PPC MAC,Internet)</p>
<p>如15213=3B6D(十六进制)</p>
<p>在小端序中:6D 3B 00 00</p>
<p>在大端序中:00 00 3B 6D</p>
<p>例外:无论是小端序还是大端序,char数组的存储顺序都是相同的,即都符合大端序,’/0’放在最高位</p>
<p>实际上,ARM的硬件配置为既能处理小端序也能处理大端序</p>
<h1 id="Lecture04-Floating-Point"><a href="#Lecture04-Floating-Point" class="headerlink" title="Lecture04:Floating Point"></a>Lecture04:Floating Point</h1><p>小数/分数的二进制表示:<script type="math/tex">\sum_{k=-j}^{i}{b_{i}*2^{k} }</script>(小数点左侧0~i,右侧-1~-j)</p>
<p>如果是分数—&gt;依次减1/2,1/4,1/8判断该位是否为1</p>
<p>如果固定位数,将point左移,则能表示的最大值变小了,精度变大;将point右移,则精度变小,能表示的最大值变小了,故采用floating point,即浮点来表示小数</p>
<hr>
<p>IEEE(电气电子工程师学会) floating point:</p>
<p>形式:<script type="math/tex">(-1)^{s}*M*2^{E}</script></p>
<p>Sign bit 表示了该数是正是负;Significand/Mantissa表示一个介于[1.0,2.0)之间的值;而Exponent表示了该值要乘上2的多少次方</p>
<p>单精度浮点数(32位):s占一位,exp占8位,frac占23位;双精度浮点数(64位):s占一位,exp占11位,frac占52位;80位浮点数(Intel only):s占1位,exp占15位,frac占63位或64位(所以为什么不直接取64位呢?)</p>
<hr>
<p>Normalized values:</p>
<p>exp域(阶码字段)决定了E,但不等于E,同时,exp域不能全为0或全为1.exp域视作一个unsigned number,exp域的值-bias(偏移量,值为<script type="math/tex">2^{k-1}-1</script>)后才是E.(example:exp占8位,则bias为127,exp域本身的范围是1~254,加上偏移量后是-126~127).</p>
<p>注意,为何不用exp域不使用signed number的标准—&gt;便于浮点数之间比较</p>
<p>significand域(尾数域/frac)决定了M,但不等于M,其采用隐含编码法.即假设M=1.xxxxxx始终成立,可以省去一位来表示小数点前的1,所以尾数域全0时尾数最小为1,尾数域全1时尾数最大,极其接近2.0</p>
<hr>
<p>Denormalized values:</p>
<p>来源:当我们想表示0or非常接近0的数时,尾数域隐含的1限制了我们</p>
<p>解决措施:当exp全为0时,其值不是0-bias,而是1-bias.同时,尾数域隐含的1变为0,即0.xxxxxx</p>
<p>example:</p>
<ol>
<li>exp全为0,frac全为0,则此时值为0,但注意有(+0和-0的区别)</li>
<li>exp全为0,frac不全为0,则此时值很接近0(0.xxxxx的-126次方)</li>
</ol>
<hr>
<p>Special values:</p>
<p>当exp全为1时:</p>
<ol>
<li>若frac全为0,则表示一个<script type="math/tex">{\infty}</script>,如<script type="math/tex">1.0/0.0=-1.0/-0.0={+\infty}</script>,<script type="math/tex">1.0/-1.0={-\infty}</script></li>
<li>frac不为0,表示Not-a-Number(NaN),表示无法确定的值,如sqrt(-1),<script type="math/tex">{\infty}-{\infty}</script>,<script type="math/tex">{\infty}*0</script></li>
</ol>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2357" alt="">.png)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2358" alt="">.png)</p>
<p>相关性质:比较浮点数的大小时,除了NaN,都可以将其视作unsigned number比较(即从高到低依次相比):正数总是比负数大;当exp不全为0时,exp域大的数总是比exp域小的数大(最高位是隐含的1);当exp全为0时,尾数域大的总是比尾数域小的数大</p>
<hr>
<p>Floating Point Operations(addition,multiplication)</p>
<p>rounding(舍入):</p>
<ol>
<li>towards zero(向零舍入)</li>
<li>round down(向负无穷舍入,即舍入后的值&lt;=舍入前的值)</li>
<li>round up(向正无穷舍入,即舍入后的值&gt;=舍入前的值)</li>
<li>default:nearest even(向最靠近的值舍入,偶数优先,如1.4-1,1.6-2,1.5-2,2.5-2,-1.5—2)</li>
</ol>
<p>为什么采用IEEE采用nearest even作为默认舍入规则:当给定<strong>足够多</strong>数据时,这些数据有50%的概率增加或减少,故平均值保持不变(可能不够严谨,但至少能说明为什么该规则较优)</p>
<p>而应用到二进制数上:偶数即有效位的最低位是0,而中间值(即’0.5’)是10000….,其他都同理</p>
<hr>
<p>Floating Point Multiplication:</p>
<p>符号位取异或,exp域相加,尾数域相乘</p>
<p>如果尾数域&gt;=2,右移,增加exp</p>
<p>如果exp超出范围,overflow</p>
<p>对尾数域相乘结果进行舍入以对应尾数域精确度</p>
<hr>
<p>Floating Point Addition:</p>
<p>首先对齐小数点(即exp域取二者中较大值),然后相加</p>
<p>若尾数域&gt;=2,右移,增加exp</p>
<p>若尾数域<1,左移k位使其>=1,exp减少k</p>
<p>如果exp超出范围,overflow</p>
<p>对尾数域相加结果进行舍入以对应尾数域精确度</p>
<hr>
<p>注意,浮点数的加法,乘法均不满足结合律,如(1e20+3.14)-1e20=0,(1e20-1e20)+3.14=3.14</p>
<p>(1e20*1e20)*1e-20=inf,1e20*(1e20*1e-20)=1e20</p>
<p>在”自然”条件中,值通常是连续的,即不会相差太大,浮点数的该性质通常不会产生影响.但是在非自然条件中,如金融行业中的计算,需要注意该性质对结果的影响.</p>
<hr>
<p>C语言中的浮点数</p>
<p>当浮点数和int之间发生类型转化时,不能保持bit-vector不变而只改变翻译方式</p>
<p>double/float—&gt;int:</p>
<ol>
<li>截去小数(效果如同向0舍入)</li>
<li>当浮点数的值超出范围或者为NaN时,没有定义,通常情况下会设置为TMin</li>
</ol>
<p>int—&gt;double:</p>
<ol>
<li>如果int的位数小于等于53(double的尾数域长度),值将不会改变</li>
</ol>
<p>int—&gt;float:</p>
<ol>
<li>同理double,若尾数域长度小于int位数,将会发生舍入</li>
</ol>
<h1 id="Lecture05-Machine-Level-Programing-I-Basics"><a href="#Lecture05-Machine-Level-Programing-I-Basics" class="headerlink" title="Lecture05:Machine-Level Programing I:Basics"></a>Lecture05:Machine-Level Programing I:Basics</h1><p>一般说machine program有两种含义,一是计算机实际运行的object code(是一系列代表着实际操作的字节);二是汇编代码(编译器的目标便是将代码转化成汇编代码).二者是一一对应的.</p>
<p>x86机器有两种汇编语言,一种是Intel和Microsoft使用的,一种是Linux使用的(本课程使用).二者参数顺序不同.</p>
<p>本课程采用的是英特尔64位processors(处理器)的指令集</p>
<hr>
<p>英特尔processors的历史:</p>
<p>x86是对英特尔processer的一个口头称呼,因为芯片名字都含有86</p>
<p>x86的特性总是不断进化\重叠,其指令集或许不是最清晰易懂的,却是最uesful的</p>
<p>80年代的RISC(reduced instructions set computer,即精简指令集计算机)和CISC(complex instructions set computer,复杂指令计算机.实际上,CISC是RISC派给以前的处理器起的名,带有贬义色彩,乐)大战</p>
<p>英特尔采用CISC架构 </p>
<hr>
<p>8086:1978年推出,是第一个16位Intel processor,有1MB的内存空间,其一个变种是IBS和DOS的基础</p>
<p>386:1985年推出,也被称作IA32,因为其是第一个32位Intel processor.添加了”flat addressing”,能运行Unix或Lunix</p>
<p>Pentium 4E:2004年推出,也被称作x86-64,因为其是第一个64位Intel processor(其也可运行32位代码,避免了software从32位到64位的长久迭代)(到这一代为止,Intel processor的性能都在逐步提升,但面对着功耗过高的问题,引出了多核processor(可以理解为在一个芯片上塞多个处理器))</p>
<p>Core 2:2006年推出,是第一个multi-core(多核)Intel Processor</p>
<p>Core i7:2008年推出,其拥有4个core</p>
<hr>
<p>Processors有Desktop Model(一般功率更高)和Server Model(Cores一般更多)两种</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/屏幕截图(2359" alt="">.png)</p>
<p>DDR:processor链接到主存储器的方式,即DRAM/动态RAM</p>
<p>PCI是与外部设备的连接</p>
<p>SATA是与不同类型盘的连接</p>
<p>Ethernet(以太网接口)连接到一个网路</p>
<p>这些逻辑单元和处理器一起组成了芯片</p>
<hr>
<p>Advanced Micro Decvices:AMD(Intel的对手,和Intel之间吵过专利,结果是AMD被允许生产x86处理器)</p>
<p>AMD提出了64位英特尔扩展程序</p>
<hr>
<p>2001年,Intel投入大量资金,试图从IA32转变到IA64,在市场上没有成功</p>
<p>而AMD将寄存器变大,只是将东西从32位变成64位,并获得了成功,于是Intel跟随其脚部继续推出x86</p>
<hr>
<p>ARM(Acorn RISC Machine),一家公司推出的自家芯片,然后公司华丽丽的破产了,但是其指令集非常高效且简单,可以设置在芯片上,且可定制</p>
<p>所以ARM现在是一家位于英国剑桥的公司,向其他公司出售使用其设计的许可权利(其比x86机器功耗更低)</p>
<hr>
<p>如前言所说,编译器的目标是将你的code转化成电脑操作的指令,但有些指令更简单,却需要更多硬件,有些指令很繁琐,但不需要什么硬件条件,而如何最好的实现指令集,是硬件研究者的工作</p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2360" alt="">.png)</p>
<p>pc:Program counter,存储下一条指令的地址,在x86-64中被称作”RIP”</p>
<p>register:存储数据(有各自的名字,如%rbx,%rdx等等)</p>
<p>condition code:存储操作的状态信息,在branching(“分支”)中使用</p>
<p>Memory:可以视作一个巨大的字节数组,实际上是操作系统和硬件协调产生的一种”虚拟内存”,每个软件都有自己独立的字节数组,而在物理意义上,所有软件都共享这些字节数组(cache指的是多次访问同一位置的内存总是更快,但注意,在指令层面,你无法直接操作cache)</p>
<hr>
<p>将C 转变成object code:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2361" alt="">.png)</p>
<p>第一步是将C代码变成汇编代码(gcc -Og -S,-Og是对编译器进行什么优化的规范,O是指Optimize,如果不加,将不会进行任何优化,;-S意思是Stop,只做第一部分,即将C代码变成汇编代码)</p>
<p>第二步是通过汇编程序(Assembler)运行它,将文本形式的代码转化成字节形式</p>
<p>第三步是通过链接器(Linker),将不同的文件融合在一起</p>
<p>(你的各个代码文件和库代码)</p>
<p>实际上,当真正开始运行这个程序上时,有些库是在首次启动时动态导入</p>
<hr>
<p>1.将C转化成Assembly(汇编代码)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2362" alt="">.png)</p>
<p>pushq:将某个数据压入栈中</p>
<p>movq:将某个数据移动位置</p>
<p>call:调用某个procedure(操作序列)</p>
<p>ret:从一个特定的函数返回</p>
<p>汇编代码中的数据类型:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2363" alt="">.png)</p>
<p>Integer类型:存储整数(不区分signed,unsigned,C中的pointer等数据类型也以该形式存储)</p>
<p>Floating point类型:以不同的方式处理,使用不同的寄存器组</p>
<p>Code:定义了一系列操作的字节序列</p>
<p>结构体等数据类型,都不存在于机器代码中,都由编译器来定义</p>
<hr>
<p>2.将汇编代码变成object code</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2364" alt="">.png)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2365" alt="">.png)</p>
<p>一些指令可能只有1byte,但也有些指令有15bytes(不同指令所代表byte长度不一定)</p>
<p>变量的所有名称,在汇编代码,机器代码级别完全丢失(变成了寄存器和内存中的某个位置)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2366" alt="">.png)</p>
<p>disassembler/反汇编(顾名思义,将object code逆推成汇编代码)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2367" alt="">.png)</p>
<p>gdb:强大的debugger,可以在存在source code的情况下进行调试,不存在source code时,也可进行调试,其也具有反汇编功能(disassemble xxxx)</p>
<p>x/14xb sumstore—显示从sumstore地址开始的14个十六进制byte</p>
<hr>
<p>更多的汇编基础知识:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2368" alt="">.png)</p>
<p>注意:如果你使用%r版本,使用的是64位register;如果你使用%e版本,使用的是32位register(实际上,%e版本只是使用了%r版本的低32位,同理,8位,16位都可取到)</p>
<p>rsp是特殊的寄存器,被称为栈指针(stack point)</p>
<p>左半部分寄存器(除rsp)的命名来自其原始用途,现在这些名字只是历史遗留问题,在大多数情况下,他们都可用于保存数据</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2369" alt="">.png)</p>
<p>注意,从IA32到64位处理器,寄存器数量增加了一倍</p>
<hr>
<p>movq operation:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2371" alt="">.png)</p>
<p>注意,不能将内存中的数据直接移动到内存中的另一个地方,需要两次操作(Mem-Reg,Reg-Mem)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2372" alt="">.png)</p>
<p>(%xxx)表示对该寄存器所存储的地址解引用</p>
<p>D(%xxx),D是一个数字,表示对该寄存器所存储的地址加一个偏移量后解引用</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2373" alt="">.png)</p>
<p>swap函数示例</p>
<p>对地址解引用的更多操作:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2375" alt="">.png)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2376" alt="">.png)</p>
<p>leaq(load effective address):地址操作</p>
<p>有些乘法操作可以转化成leaq,如*12—&gt;*3再*4</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2377" alt="">.png)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2379" alt="">.png)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2380" alt="">.png)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2382" alt="">.png)</p>
<h1 id="Lecture06-Machine-Level-Programing-II-Control"><a href="#Lecture06-Machine-Level-Programing-II-Control" class="headerlink" title="Lecture06:Machine-Level Programing II:Control"></a>Lecture06:Machine-Level Programing II:Control</h1><p>Condition codes:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2383" alt="">.png)%rip:指令指针(instruction pointer,在IA32中中叫%eip),包含正在执行指令的地址,无法通过<strong>正常方式</strong>操作(可通过技巧获取它的值)</p>
<p>condition codes一共有8个,图中只展示了4个,都只有1bit</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2384" alt="">.png)</p>
<p>CF:在二进制加法时,表示是否进位(翻译为溢出更恰当?)</p>
<p>ZF:当计算结果为0时被置位</p>
<p>SF:计算结果最高位为1时(signed)被置位</p>
<p>OF:当signed计算溢出时被置位(包括加,乘?)</p>
<p>注意,lea不会操作这4个condition code</p>
<p>专门操作condition code的指令:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2386" alt="">.png)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2387" alt="">.png)</p>
<p>获取condition code的手段:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2388" alt="">.png)</p>
<p>setX根据condition code的状态,将目标寄存器的低位,置1或置0,以此来知道最近的指令做了什么</p>
<p>sete,setne表示上次指令的结果是相等或为零</p>
<p>sets,setns表示上次指令的结果的正负性(没有考虑溢出)</p>
<p>setg,setge表示上次指令的结果是大于(大于或等于),这里用了~(SF^OF)表示大于或等于,即考虑了正溢出和负溢出,保证了比大小不会因为溢出出错</p>
<p>setl,setle同理</p>
<p>setb表示上次指令结果是否溢出(unsigned)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2389" alt="">.png)</p>
<p>%xxl表示寄存器的最后一位(l—low)</p>
<p>setX示例:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2390" alt="">.png)</p>
<p>PS:x86-64的小特性:当你操作32位寄存器时,会将寄存器的其余32位置为0.</p>
<p>而byte(如short)操作不动其他位(更低位也如此)</p>
<hr>
<p>Conditional branches:</p>
<p>if和else</p>
<p>传统的实现方法:jump instruction</p>
<p>unconditional jump(无条件跳跃)</p>
<p>conditonal jump(有条件跳跃)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2391" alt="">.png)</p>
<p>示例:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2392" alt="">.png)</p>
<p>.XXX:label,在object code中并不存在(代表了指令的地址?)</p>
<hr>
<p>优化:Conditional Moves(类似于先将if的结果和else的结果都算出来,根据条件值判断使用哪个)</p>
<p>先猜测条件结果(大部分情况下都能猜对),并直接开始计算</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2394" alt="">.png)</p>
<p>可以类比工厂的工作流水线,可以同一时间处理多条指令,而不是卡在条件指令,使之更有效率</p>
<p>示例:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2395" alt="">.png)</p>
<p>注意,conditional move仅在分支计算都很简单的时候能提高效率,在某些情况下甚至有风险(如解引用NULL指针),有时计算结果影响条件判断</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2396" alt="">.png)</p>
<hr>
<p>loops:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2397" alt="">.png)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2398" alt="">.png)</p>
<p>dowhile循环的实现</p>
<hr>
<p>-Og级别的while:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2399" alt="">.png)</p>
<p>-O1级别的:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2400" alt="">.png)</p>
<hr>
<p>for循环</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2403" alt="">.png)</p>
<p>类似while循环</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2404" alt="">.png)</p>
<p>采用O1优化时,会删除初始化之后的一个test(因为一定对)</p>
<hr>
<p>switch:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2405" alt="">.png)</p>
<p>switch会生成一个类似于数组的jump table,以快速定位提高效率</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2406" alt="">.png)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2409" alt="">.png)</p>
<p>注意,从0到x的最大值均有其标签(如果出现负数,会添加一个bias使下标从0开始)</p>
<p>若是x的范围过大且相对稀疏(如x为0和1000000,会使用二分优化成if else)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2401" alt="">.png)</p>
<p>break代码块:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2412" alt="">.png)</p>
<p>注意,switch后即为return w,故将ret写在代码块内</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2413" alt="">.png)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Kanata369/blogimage@main/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(2414" alt="">.png)</p>
<p>只有case3中的指令需要w初始化,故将w初始化放在case3中.</p>
<p>case2fall-through到case3中,故在初始化后添加merge标签供case2跳转</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://Kanata369.github.io/2022/06/30/CF1698E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kanata's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/06/30/CF1698E/" itemprop="url">CF1698E</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-06-30T18:10:21+08:00">
                2022-06-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Codeforces/" itemprop="url" rel="index">
                    <span itemprop="name">Codeforces</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>题面:<a target="_blank" rel="noopener" href="https://codeforces.com/contest/1698/problem/E">https://codeforces.com/contest/1698/problem/E</a></p>
<!---more--->
<p>大致题意:给定a排列、b排列的部分、数值s，规定可对a排列进行如下操作:在第i次操作时，可选定下标范围在i~i+s的两个数值，进行交换(若选定的两个下标相同，则排列不变，可视为跳过一次操作)</p>
<p>求通过若干次操作，能使a排列变为b排列的b排列总数</p>
<p>题解:易想到，先求解怎样的b排列符合条件，即假定一个特定的b排列，判断是否满足条件。先上结论:若<script type="math/tex">s>max(a_{i}-b_{i})</script>，则符合条件</p>
<p>证明如下:</p>
<ol>
<li>证明:将b按大小与a一起重排后，按照新的排列考虑问题不影响结果(因为a数组已经固定，故可以理解为对a数组进行重新”投射”)</li>
<li>按<script type="math/tex">b_{i}</script>的大小从小到大考虑问题，若<script type="math/tex">b_{t}</script>=m,<script type="math/tex">a_{t}</script>大于m，则前几次操作不会涉及<script type="math/tex">a_{t}</script>(因为其大于m,与前面的b不会对应);若<script type="math/tex">a_{t}=m</script>，则不需移动，且第i次操作可直接放弃而不造成影响;若<script type="math/tex">a_{t}小于m</script>，此时a中的m所对应b大于m，则在考虑<script type="math/tex">b_{i}=a_{t}</script>中，已将其调到另外一个b处，必定可以完成操作</li>
<li>欲证明，若<script type="math/tex">b_{t}</script>=m,<script type="math/tex">a_{t}</script>大于m，则使a归位需要的s最少为a、b之差，按b大小重排后则所需<script type="math/tex">s>(a_{i}-b_{i})</script>，等效到原排列中s不变</li>
<li>已知s，对每个未知b，可知道其可能值的个数(可能值从小到大排)，故从可能值个数较小的b开始考虑</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">int64_t</span>;</span><br><span class="line"><span class="comment">/*head*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FOR(i, a, b) for (ll i = (a); i &lt;= (b); i++)</span></span><br><span class="line"><span class="comment">//#define DE_BUG</span></span><br><span class="line"><span class="comment">/*define*/</span></span><br><span class="line"></span><br><span class="line">ll T, n, m, k, tt = <span class="number">0</span>, ss;</span><br><span class="line">ll tmp, a[<span class="number">300005</span>], b[<span class="number">300005</span>];</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="comment">// 1 0</span></span><br><span class="line"><span class="comment">// 2 0</span></span><br><span class="line"><span class="comment">// 3 1</span></span><br><span class="line"><span class="comment">// 4 1</span></span><br><span class="line"><span class="comment">// 5 2</span></span><br><span class="line"><span class="comment">// 6 2</span></span><br><span class="line"><span class="comment">// 7 3</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="type">bool</span> flag = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; ss;</span><br><span class="line">    set&lt;ll&gt; s;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; a[i];</span><br><span class="line">        s.<span class="built_in">insert</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; b[i];</span><br><span class="line">        <span class="keyword">if</span> (b[i] != <span class="number">-1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i] - b[i] &gt; ss)</span><br><span class="line">            &#123;</span><br><span class="line">                flag = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            s.<span class="built_in">erase</span>(b[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!flag)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;0\n&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;ll&gt; cnt;</span><br><span class="line">    <span class="function">vector&lt;ll&gt; <span class="title">s2</span><span class="params">(s.begin(), s.end())</span></span>;</span><br><span class="line">    <span class="built_in">sort</span>(s2.<span class="built_in">begin</span>(), s2.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(b[i]==<span class="number">-1</span>)<span class="comment">//b&gt;=a[i]-s</span></span><br><span class="line">        &#123;</span><br><span class="line">            ll tmp = s2.<span class="built_in">end</span>()-<span class="built_in">lower_bound</span>(s2.<span class="built_in">begin</span>(), s2.<span class="built_in">end</span>(),a[i]-ss);</span><br><span class="line">            <span class="comment">//cout &lt;&lt; tmp &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">            cnt.<span class="built_in">push_back</span>(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll tmp = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">sort</span>(cnt.<span class="built_in">begin</span>(), cnt.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> e:cnt)</span><br><span class="line">    &#123;</span><br><span class="line">        ans = ans * ((e - tmp)%mod);</span><br><span class="line">        ans %= mod;</span><br><span class="line">        tmp++;</span><br><span class="line">        tmp %= mod;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; (ans+mod)%mod &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> DE_BUG</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;TIME==&quot;</span> &lt;&lt; (ll)(<span class="built_in">clock</span>()) - tt &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        tt = (ll)<span class="built_in">clock</span>();</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>码力太弱哩，就嗯写，时间复杂度大概是nlogn</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://Kanata369.github.io/2022/06/27/Lucas%E6%9D%BF%E5%AD%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kanata's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/06/27/Lucas%E6%9D%BF%E5%AD%90/" itemprop="url">Lucas板子</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-06-27T20:08:05+08:00">
                2022-06-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">算法学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>适用于mod数较小，而实际计算时需要的阶乘数较大时，只需预处理出mod数范围内的阶乘即可</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">Cal</span><span class="params">(ll u, ll d, ll i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (d &lt; u)<span class="comment">//注意返回0</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (d == <span class="number">0</span>||d==u)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> ((jc[d][i] * jc_inv[u][i] % mod[i]) * jc_inv[d - u][i])%mod[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">Lucas</span><span class="params">(ll u, ll d, ll i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (d &lt; u)<span class="comment">//注意返回0</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (d == <span class="number">0</span>||d==u)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> ((<span class="built_in">Lucas</span>(u / mod[i], d / mod[i], i) % mod[i]) * <span class="built_in">Cal</span>(u % mod[i], d % mod[i], i)) % mod[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://Kanata369.github.io/2022/06/03/%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E6%95%B0%E5%AD%A6%E7%BB%93%E8%AE%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kanata's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/06/03/%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E6%95%B0%E5%AD%A6%E7%BB%93%E8%AE%BA/" itemprop="url">一些数学结论</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-06-03T14:27:43+08:00">
                2022-06-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">算法学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>质数相关:</p>
<ol>
<li>一个合数N，一定存在一个质数&lt;=<script type="math/tex">\sqrt{N}</script>并整除N(用于大范围判断质数—求出<script type="math/tex">\sqrt{N}</script>的质数表)</li>
<li>一个合数N(<1e9)最多含有10种不同的质数因子(最小的10种质数相乘已超过1e9)，每种质数因子的指数不超过30(2^31>1e9)</li>
<li>求N!阶乘的质数分解形式，则统计1~N中各个质数的指数和，即<script type="math/tex">\frac{N}{p}+\frac{N}{p^2}+\frac{N}{p^3}+...</script>(为何不是<script type="math/tex">2*\frac{N}{p^2}</script>—其中一个已统计过)</li>
<li>gcd(n,x)=gcd(n,n-x)，所以与n不互质的数成对出现—与n互质的数也成对出现(平均值为n/2)，故与n互质的数的和=<script type="math/tex">n/2*{\phi}{n}</script></li>
<li>gcd(a,b)=gcd(a,b-a),gcd(a,b,c)=gcd(a,b-a,c-b),当数目更多时同样成立，即多个数的gcd等价于其等差数组的gcd。如用线段树，区间修改数组，区间查询gcd，可用A数组记录数组初始值，用B数组维护差分数组，每次修改就转化成了两次单点修改，询问就转化成了求gcd(A[l],ask(l+1,r))</li>
<li>若<script type="math/tex">a^{x}=1(mod n)</script>,若a、n互质,则最小的正整数x为<script type="math/tex">{\phi}(n)</script>的约数(反证法—若不为约数,则<script type="math/tex">x=k*{\phi}(n)+r</script>,则r更小且满足条件)</li>
<li>求a%mod的值，而mod为非质数(如999911658)，可将mod分解成质数积，如999911658=2*3*4679*35617,分别计算a%2,a%3,a%4679,a%35617,这几个数互质,可得出一个线性同余方程组,运用CRT求解得到a%mod的值</li>
<li>原根、离散对数:给定质数p，若有一个数r满足gcd(r,p)=1,且<script type="math/tex">r^{1}~r^{p-1}</script>次方刚好遍历了<script type="math/tex">Z_{p}</script>(即小于p且与p互质的所有数)，则称r是p的原根(dft/idft中，998244353的对应原根是3，其他模数的原根:<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45697774/article/details/115732914)，而$$r^{e}=a(mod">https://blog.csdn.net/weixin_45697774/article/details/115732914)，而$$r^{e}=a(mod</a> p)$$，则称e是以p为模，以r为底时，a所对应的离散对数。原根具有循环性，被应用于模意义下的fft。</li>
<li>伪素数:若<script type="math/tex">a^{n-1}==1(mod n)</script>，且n是合数，则称n是以a为底的伪素数，实践中可通过取多个底来判断n是否是素数(注意，存在合数，满足其是任意底的伪素数，故没法百分百确定)</li>
<li>若a+b=c,则a与b互质的充要条件是a和c也互质(故a+b=c且a与b互质的对数为phi[c])</li>
<li>计算阶乘相关时,可能出现分子,分母阶乘mod后均为0,实际结果不为0的情况(因为可能其因数相消将mod数p消去),此时要求出各个阶乘提取p后的结果—根据威尔逊定理((p-1)!==-1 mod p)</li>
</ol>
<p>约数相关:</p>
<ol>
<li>对任意的x&lt;=i&lt;=k/(k/x),k/i结果均相同</li>
<li>对任意的1&lt;=i&lt;=k,k/i最多有<script type="math/tex">2*\sqrt{k}</script>种结果(结合1可快速对k/i区间求和)</li>
</ol>
<p>排列组合相关:</p>
<ol>
<li><p>i个数的错排总数:f[i]=(i-1)*(f[i-1]+f[i-2]),f[1]=0,f[0]=1(例题:<a target="_blank" rel="noopener" href="https://www.acwing.com/problem/content/description/232/">https://www.acwing.com/problem/content/description/232/</a>)</p>
</li>
<li><p>给定一个子串，求长度为m的母串，满足该子串是该母串的不连续子序列的总数：首先，明确如何在母串中规定出“唯一”子串的位置，假设子串为s，母串为p，s[i]与p[j]匹配，s[i+1]与p[k]匹配，则p[j+1]~p[k-1]中，不允许出现s[i](若出现，则该位置才是s[i]匹配位置)，通过该方法，我们可根据子串的字符在母串中的匹配位置(易知匹配位置不同，则母串必不同，故不会重合)，计算该匹配位置有多少种母串(根据上述限制)，而不同的匹配位置可使用dp[i][j]表示母串的第i个字符匹配子串的第j个字符表示，进而递推(来源:<a target="_blank" rel="noopener" href="https://blog.nowcoder.net/n/aaf4e85f4c7c4c059de3c9c4f2ff91fc">https://blog.nowcoder.net/n/aaf4e85f4c7c4c059de3c9c4f2ff91fc</a>)</p>
</li>
<li><script type="math/tex; mode=display">\sum_{k=1}^{n}{(-1)^{k} }C(n,k)=(1-1)^{n}=0</script></li>
<li><script type="math/tex; mode=display">\sum_{k=1}^{n}{(2)^{k} }C(n,k)=(2+1)^{n}=3^{n}</script></li>
<li><script type="math/tex; mode=display">C(n+1,k)=C(n,k-1)+C(n,k)</script></li>
<li><p>范德蒙德恒等式:<script type="math/tex">C(m+n,r)=\sum_{k=0}^{r}C(m,k)*C(n,r-k)</script>,进而<script type="math/tex">C(2n,n)=\sum_{k=0}^{n}{C(n,k)}^{2}</script></p>
</li>
<li><p><script type="math/tex">C(n+1,r+1)=\sum_{j=r}^{n}C(j,r)</script>(01串中，枚举最后一个1的出现位置从r+1到n+1)</p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://Kanata369.github.io/2022/05/27/CF1686E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kanata's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/05/27/CF1686E/" itemprop="url">CF1686E</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-05-27T22:16:51+08:00">
                2022-05-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Codeforces/" itemprop="url" rel="index">
                    <span itemprop="name">Codeforces</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>题面:<a target="_blank" rel="noopener" href="https://codeforces.com/contest/1686/problem/E">https://codeforces.com/contest/1686/problem/E</a></p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2022/05/27/CF1686E/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://Kanata369.github.io/2022/05/25/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83-%E6%A8%A1%E6%9D%BF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kanata's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/05/25/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83-%E6%A8%A1%E6%9D%BF/" itemprop="url">高斯消元(模板)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-05-25T01:05:13+08:00">
                2022-05-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">算法学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>没啥讲的，纯模板</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">gauss</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">double</span>&gt;&gt; <span class="built_in">a</span>(n,<span class="built_in">vector</span>&lt;<span class="type">double</span>&gt;(n+<span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;=n;j++)<span class="comment">//多出一维增广矩阵</span></span><br><span class="line">        &#123;</span><br><span class="line">            cin&gt;&gt;a[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> mx=i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>;j&lt;n;j++)<span class="comment">//找出第i列中最大元素</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">fabs</span>(a[j][i])&gt;<span class="built_in">fabs</span>(a[mx][i]))</span><br><span class="line">            &#123;</span><br><span class="line">                mx=j;</span><br><span class="line">            &#125;</span><br><span class="line">		&#125;</span><br><span class="line">        <span class="built_in">swap</span>(a[mx],a[j]);<span class="comment">//将最大元素所在行换到第i行</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">fabs</span>(a[i][i])&lt;<span class="number">1e-9</span>)<span class="comment">//该列元素都为0的情况</span></span><br><span class="line">        &#123;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;No ans!&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(j!=i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">double</span> tmp=a[j][i]/a[i][i];</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k=i;k&lt;=n;k++)</span><br><span class="line">                &#123;</span><br><span class="line">                    a[j][k]-=a[i][k]*tmp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>莫名奇妙上面一个写挂了。。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">gauss</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">double</span>&gt;&gt; <span class="built_in">a</span>(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">double</span>&gt;(n + <span class="number">1</span>));</span><br><span class="line">    vector&lt;vector&lt;<span class="type">double</span>&gt;&gt; <span class="built_in">b</span>(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">double</span>&gt;(n + <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (ll j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            cin &gt;&gt; b[i][j]; <span class="comment">//第i个点的第j维</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt;n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        a[i][n] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            a[i][j] = <span class="number">-2</span> * (b[i][j] - b[(i + <span class="number">1</span>) % (n + <span class="number">1</span>)][j]);</span><br><span class="line">            a[i][n] += b[(i + <span class="number">1</span>) % (n + <span class="number">1</span>)][j] * b[(i + <span class="number">1</span>) % (n + <span class="number">1</span>)][j];</span><br><span class="line">            a[i][n] -= b[i][j] * b[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (ll j = i; j &lt; n;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">fabs</span>(a[j][i])&gt;<span class="number">1e-8</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">swap</span>(a[i], a[j]);<span class="comment">//使a[i][i]&gt;1e-8</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (ll j = <span class="number">0</span>; j &lt; n;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(i==j)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">double</span> rate = a[j][i] / a[i][i];</span><br><span class="line">            <span class="keyword">for</span> (ll k = i; k &lt;= n;k++)</span><br><span class="line">            &#123;</span><br><span class="line">                a[j][k] -= a[i][k] * rate;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;a[i][n]/a[i][i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>题面:<a target="_blank" rel="noopener" href="https://www.acwing.com/problem/content/209/">https://www.acwing.com/problem/content/209/</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">gauss</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;vector&lt;ll&gt;&gt; <span class="built_in">a</span>(m + <span class="number">1</span>, <span class="built_in">vector</span>&lt;ll&gt;(n + <span class="number">2</span>, <span class="number">0</span>));</span><br><span class="line">    <span class="comment">// vector&lt;ll&gt; c(n + 1);</span></span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    ll num = <span class="number">0</span>;</span><br><span class="line">    string str1, str2;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; k;</span><br><span class="line">        cin &gt;&gt; str1 &gt;&gt; str2;</span><br><span class="line">        a[i][n + <span class="number">1</span>] = (mp[str2] - mp[str1] + <span class="number">8</span>) % <span class="number">7</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll j = <span class="number">1</span>; j &lt;= k; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            cin &gt;&gt; num;</span><br><span class="line">            a[i][num] = (a[i][num] + <span class="number">1</span>) % <span class="number">7</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*for (ll i = 1; i &lt;= m; i++)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        for (ll j = 1; j &lt;= n + 1; j++)</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            cout &lt;&lt; a[i][j] &lt;&lt; &quot; &quot;;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        cout &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">    <span class="comment">// sort(a.begin() + 1, a.begin() + n + 1,cmp);</span></span><br><span class="line">    ll row = <span class="number">1</span>, col = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//vector&lt;ll&gt; pos;</span></span><br><span class="line">    <span class="keyword">for</span> (row = <span class="number">1</span>, col = <span class="number">1</span>;row&lt;=m&amp;&amp;col&lt;=n; row++,col++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (ll j = row; j &lt;= m; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[row][col] == <span class="number">0</span> &amp;&amp; a[j][col] != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">swap</span>(a[row], a[j]);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (a[row][col] == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            row--;</span><br><span class="line">            ans = <span class="number">1</span>;<span class="comment">//出现自由元</span></span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//pos.push_back(col);</span></span><br><span class="line">        <span class="keyword">for</span> (ll j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (row == j || a[j][col] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// double rate = a[j][i] / a[i][i];</span></span><br><span class="line">            ll rate1 = a[j][col] / <span class="built_in">gcd</span>(a[j][col], a[row][col]);</span><br><span class="line">            ll rate2 = a[row][col] / <span class="built_in">gcd</span>(a[j][col], a[row][col]);</span><br><span class="line">            <span class="keyword">for</span> (ll k = <span class="number">1</span>; k &lt;= n + <span class="number">1</span>; k++)</span><br><span class="line">            &#123;</span><br><span class="line">                a[j][k] = (a[j][k] * rate2 - a[row][k] * rate1)%<span class="number">7</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ll flag = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll j = <span class="number">1</span>; j &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(a[i][j]!=<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                flag = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (flag == <span class="number">0</span> &amp;&amp; a[i][n + <span class="number">1</span>]%<span class="number">7</span>!= <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ans = <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(ans==<span class="number">0</span>&amp;&amp;n&gt;m)</span><br><span class="line">    &#123;</span><br><span class="line">        ans = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*for (ll i = 1; i &lt;= m; i++)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        for (ll j = 1; j &lt;= n + 1; j++)</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            cout &lt;&lt; a[i][j] &lt;&lt; &quot; &quot;;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        cout &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">    <span class="keyword">if</span> (ans == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Inconsistent data.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (ans == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Multiple solutions.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            ll ret = (<span class="built_in">quick</span>(a[i][i]%<span class="number">7</span>, <span class="number">5</span>) * a[i][n + <span class="number">1</span>] % <span class="number">7</span> + <span class="number">7</span>) % <span class="number">7</span>;</span><br><span class="line">            <span class="comment">//ret = (ret + 7) % 7 + 3;</span></span><br><span class="line">            <span class="keyword">if</span>(ret&lt;<span class="number">3</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ret = ret + <span class="number">7</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            cout &lt;&lt; ret &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; num &lt;&lt; &quot; &quot; &lt;&lt; ans &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该模板适用于整数mod7方程组，且使用了row、col两个变量来分辨无解、多解的情况</p>
<p>题面:<a target="_blank" rel="noopener" href="https://www.acwing.com/problem/content/description/229/">https://www.acwing.com/problem/content/description/229/</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/">&lt;</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/4/">&gt;</a>
  </nav>




          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1496089152&auto=0&height=66"></iframe>
      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/">
              
                  <span class="site-state-item-count">66</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://www.zhihu.com/people/dyg-55" target="_blank" title="Zhihu">
                      
                        <i class="fa fa-fw fa-globe"></i>Zhihu</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友链
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://tangdouer.cn" title="糖豆儿" target="_blank">糖豆儿</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://gdgao.top/" title="果冻" target="_blank">果冻</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Kanata</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a></div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
	//下面的HTML-CSS和SVG用于在小屏幕上，数学公式可以自动换行，我测试过后发现无效，但是貌似有人可以。
	"HTML-CSS": { 
		linebreaks: { 
			automatic: true 
		} 
	},SVG: {
		linebreaks: { 
			automatic: true 
		}
	},menuSettings: {
		zoom: "None"
	},
	showMathMenu: false,
	jax: ["input/TeX","output/CommonHTML"],
	extensions: ["tex2jax.js"],
	TeX: {
		extensions: ["AMSmath.js","AMSsymbols.js"],
		equationNumbers: {
			autoNumber: "AMS"
		}
	},tex2jax: {
		inlineMath: [["\\(", "\\)"]],
		displayMath: [["\\[", "\\]"]]
	}
});
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":true,"model":{"scale":1.5,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/assets/miku.model.json"},"display":{"superSample":2,"width":150,"height":300,"position":"right","hOffset":0,"vOffset":-20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false});</script></body>
</html>
